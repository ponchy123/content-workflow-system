import{h as F,r as i,a as A,o as M,i as $,x as e,p as H,N as O,t as l,y as m,at as j,aw as W,aP as z,q as o,aV as p,as as G,A as J,H as f,aI as K,L as _,aH as Q,au as X,E as h,P as Y,j as C}from"./vendor-BxNawP4f.js";import{d as Z,e as ee,c as ae}from"./index-N1Xkh6eW.js";import{P as q}from"./AddressSelector.vue_vue_type_style_index_0_lang-DCS-l7wX.js";import{_ as le}from"./index-DyxCg8e9.js";import{_ as te}from"./FormCard.vue_vue_type_script_setup_true_lang-C9NvR83c.js";import{a as V}from"./index-DdmqVHKO.js";/* empty css                                                                        */const re={class:"compare-container"},se={class:"card-header"},oe={class:"total-charge"},ue=F({__name:"compare",setup(ne){Y();const b=i(),g=i(!1),t=i({fromAddress:"",toAddress:"",weight:1,length:10,width:10,height:10,productType:"",serviceLevel:"",insuranceValue:0,isDangerous:!1,quantity:1}),E=i([]),D=i([]),y=i([]),x=i(null),T=i(null),U=s=>{x.value=s},k=s=>{T.value=s},w=A(()=>{const{length:s,width:a,height:u}=t.value;return Number((s*a*u/6e3).toFixed(1))});A(()=>Math.max(w.value,t.value.weight));const N={fromAddress:[{required:!0,message:"请输入起始地邮编",trigger:"blur"},{pattern:/^\d{6}$/,message:"请输入正确的邮政编码",trigger:"blur"}],toAddress:[{required:!0,message:"请输入目的地邮编",trigger:"blur"},{pattern:/^\d{6}$/,message:"请输入正确的邮政编码",trigger:"blur"}],weight:[{required:!0,message:"请输入重量",trigger:"blur"},{type:"number",min:.1,message:"重量必须大于0.1kg",trigger:"blur"}],length:[{required:!0,message:"请输入长度",trigger:"blur"},{type:"number",min:1,message:"长度必须大于1cm",trigger:"blur"}],width:[{required:!0,message:"请输入宽度",trigger:"blur"},{type:"number",min:1,message:"宽度必须大于1cm",trigger:"blur"}],height:[{required:!0,message:"请输入高度",trigger:"blur"},{type:"number",min:1,message:"高度必须大于1cm",trigger:"blur"}],productType:[{required:!0,message:"请选择产品类型",trigger:"change"}],serviceLevel:[{required:!0,message:"请选择服务等级",trigger:"change"}]},L=async()=>{try{const[s,a]=await Promise.all([Z(),ee()]);E.value=s.data.map(u=>({code:u.code,name:u.name})),D.value=a.data.map(u=>({code:u.code,name:u.name}))}catch(s){console.error("Failed to fetch options:",s),h.error("获取选项数据失败")}},P=async()=>{b.value&&await b.value.validate(async s=>{if(s){g.value=!0;try{const a=await ae({fromAddress:t.value.fromAddress,toAddress:t.value.toAddress,weight:t.value.weight,volume:w.value,quantity:t.value.quantity,productType:t.value.productType,serviceLevel:t.value.serviceLevel,insuranceValue:t.value.insuranceValue,isDangerous:t.value.isDangerous});y.value=a.data}catch{h.error("比较失败")}finally{g.value=!1}}})},R=async()=>{try{g.value=!0,h.success("结果已保存到历史记录")}catch(s){console.error("Failed to save results:",s),h.error("保存失败，请重试")}finally{g.value=!1}};return M(()=>{L()}),(s,a)=>{const u=J,n=z,d=W,v=j,S=G,c=K,B=Q,I=X;return C(),$("div",re,[e(o(te),{title:"产品比较",ref_key:"formRef",ref:b,model:t.value,rules:N,"label-position":"right","label-width":"120px"},{actions:l(()=>[e(u,{type:"primary",onClick:P,loading:g.value},{default:l(()=>a[9]||(a[9]=[f(" 开始比较 ")])),_:1},8,["loading"])]),default:l(()=>[a[10]||(a[10]=m("h3",{class:"form-group-title"},"基本信息",-1)),e(v,{gutter:20},{default:l(()=>[e(d,{span:12},{default:l(()=>[e(n,{label:"起始地邮编",prop:"fromAddress"},{default:l(()=>[e(o(q),{modelValue:t.value.fromAddress,"onUpdate:modelValue":a[0]||(a[0]=r=>t.value.fromAddress=r),placeholder:"请输入或搜索起始地邮编",onAddressChange:U},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:l(()=>[e(n,{label:"目的地邮编",prop:"toAddress"},{default:l(()=>[e(o(q),{modelValue:t.value.toAddress,"onUpdate:modelValue":a[1]||(a[1]=r=>t.value.toAddress=r),placeholder:"请输入或搜索目的地邮编",onAddressChange:k},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a[11]||(a[11]=m("h3",{class:"form-group-title"},"包裹信息",-1)),e(v,{gutter:20},{default:l(()=>[e(d,{span:12},{default:l(()=>[e(n,{label:"重量",prop:"weight"},{default:l(()=>[e(o(p),{modelValue:t.value.weight,"onUpdate:modelValue":a[2]||(a[2]=r=>t.value.weight=r),min:.1,step:.1,precision:1},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:l(()=>[e(n,{label:"数量",prop:"quantity"},{default:l(()=>[e(o(p),{modelValue:t.value.quantity,"onUpdate:modelValue":a[3]||(a[3]=r=>t.value.quantity=r),min:1},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(v,{gutter:20},{default:l(()=>[e(d,{span:8},{default:l(()=>[e(n,{label:"长",prop:"length"},{default:l(()=>[e(o(p),{modelValue:t.value.length,"onUpdate:modelValue":a[4]||(a[4]=r=>t.value.length=r),min:1,precision:1},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:8},{default:l(()=>[e(n,{label:"宽",prop:"width"},{default:l(()=>[e(o(p),{modelValue:t.value.width,"onUpdate:modelValue":a[5]||(a[5]=r=>t.value.width=r),min:1,precision:1},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:8},{default:l(()=>[e(n,{label:"高",prop:"height"},{default:l(()=>[e(o(p),{modelValue:t.value.height,"onUpdate:modelValue":a[6]||(a[6]=r=>t.value.height=r),min:1,precision:1},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a[12]||(a[12]=m("h3",{class:"form-group-title"},"其他信息",-1)),e(v,{gutter:20},{default:l(()=>[e(d,{span:12},{default:l(()=>[e(n,{label:"保价金额",prop:"insuranceValue"},{default:l(()=>[e(o(p),{modelValue:t.value.insuranceValue,"onUpdate:modelValue":a[7]||(a[7]=r=>t.value.insuranceValue=r),min:0,precision:2,step:100},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:l(()=>[e(n,{label:"是否危险品",prop:"isDangerous"},{default:l(()=>[e(S,{modelValue:t.value.isDangerous,"onUpdate:modelValue":a[8]||(a[8]=r=>t.value.isDangerous=r)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),y.value?(C(),H(I,{key:0,class:"result-card"},{header:l(()=>[m("div",se,[a[14]||(a[14]=m("h2",null,"比较结果",-1)),e(u,{type:"primary",onClick:R},{default:l(()=>a[13]||(a[13]=[f("保存结果")])),_:1})])]),default:l(()=>[e(B,{data:y.value,border:""},{default:l(()=>[e(c,{prop:"productName",label:"产品名称"}),e(c,{prop:"baseCharge",label:"基础运费"},{default:l(({row:r})=>[f(_(o(V)(r.baseCharge)),1)]),_:1}),e(c,{prop:"fuelSurcharge",label:"燃油附加费"},{default:l(({row:r})=>[f(_(o(V)(r.fuelSurcharge)),1)]),_:1}),e(c,{prop:"totalCharge",label:"总费用"},{default:l(({row:r})=>[m("span",oe,_(o(V)(r.totalCharge)),1)]),_:1}),e(c,{prop:"estimatedDays",label:"预计送达时间"},{default:l(({row:r})=>[f(_(r.estimatedDays)+" 天 ",1)]),_:1})]),_:1},8,["data"])]),_:1})):O("",!0)])}}}),ve=le(ue,[["__scopeId","data-v-5ab0cf09"]]);export{ve as default};
